/* ═══════════════════════════════════════════════════════════
   Financial Audit Dashboard — Clean Professional Design
   ═══════════════════════════════════════════════════════════ */

@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&display=swap');

:root {
	--fa-primary: #2563eb;
	--fa-success: #059669;
	--fa-danger: #dc2626;
	--fa-warning: #d97706;
	--fa-purple: #7c3aed;
	--fa-pink: #db2777;
	--fa-teal: #0d9488;
	--fa-orange: #ea580c;
	--fa-slate: #475569;
	--fa-border: #e5e7eb;
	--fa-text: #111827;
	--fa-text-sub: #6b7280;
	--fa-radius: 10px;
}

/* ─── Force Font Everywhere ────────────────────── */
.financial-audit-page,
.financial-audit-page *,
.financial-audit-page table,
.financial-audit-page th,
.financial-audit-page td,
.financial-audit-page label,
.financial-audit-page input,
.financial-audit-page select,
.financial-audit-page button,
.financial-audit-page span,
.financial-audit-page div,
.financial-audit-page p,
.financial-audit-page h1,
.financial-audit-page h2,
.financial-audit-page h3,
.financial-audit-page h4,
.financial-audit-page a {
	font-family: 'IBM Plex Sans Arabic', 'Segoe UI', Tahoma, sans-serif !important;
}

/* ─── Page ─────────────────────────────────────── */
.financial-audit-page {
	padding: 20px;
	direction: rtl;
	text-align: right;
	width: 100%;
	background: #ffffff;
	min-height: 100vh;
	font-size: 14px;
	line-height: 1.7;
	color: var(--fa-text);
}

/* ─── Filters ──────────────────────────────────── */
.filters-section {
	padding: 14px 0;
	margin-bottom: 20px;
	border-bottom: 1px solid var(--fa-border);
}

.filters-row {
	display: flex;
	flex-wrap: wrap;
	gap: 16px;
	align-items: flex-end;
}

.filter-field {
	flex: 1;
	min-width: 200px;
}

.filter-field label {
	display: block;
	font-weight: 600 !important;
	margin-bottom: 4px;
	color: var(--fa-text);
	font-size: 13px;
}

/* ─── KPI Cards ────────────────────────────────── */
.kpi-cards {
	display: grid;
	grid-template-columns: repeat(6, 1fr);
	gap: 12px;
	margin-bottom: 28px;
}

.kpi-card {
	background: #fff;
	padding: 16px 12px 14px;
	border-radius: var(--fa-radius);
	text-align: center;
	border: 1px solid var(--fa-border);
	transition: box-shadow 0.2s ease;
	position: relative;
	overflow: hidden;
}

.kpi-card::before {
	content: '';
	position: absolute;
	top: 0; right: 0; left: 0;
	height: 3px;
}

.kpi-card:hover {
	box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.kpi-card .kpi-icon {
	width: 36px; height: 36px;
	border-radius: 8px;
	display: flex; align-items: center; justify-content: center;
	margin: 0 auto 6px;
	font-size: 14px;
}

.kpi-card .kpi-title {
	font-size: 11px;
	color: var(--fa-text-sub);
	margin-bottom: 4px;
	font-weight: 600 !important;
}

.kpi-card .kpi-value {
	font-size: 15px;
	font-weight: 700 !important;
	direction: ltr;
}

.kpi-card .kpi-desc {
	font-size: 10px;
	color: var(--fa-text-sub);
	font-weight: 400 !important;
	margin-top: 3px;
	line-height: 1.3;
}

/* KPI colors */
.kpi-card.revenue::before { background: #059669; }
.kpi-card.revenue .kpi-value { color: #059669; }
.kpi-card.revenue .kpi-icon { background: #ecfdf5; color: #059669; }

.kpi-card.cogs::before { background: #ea580c; }
.kpi-card.cogs .kpi-value { color: #ea580c; }
.kpi-card.cogs .kpi-icon { background: #fff7ed; color: #ea580c; }

.kpi-card.profit::before { background: #2563eb; }
.kpi-card.profit .kpi-value { color: #2563eb; }
.kpi-card.profit .kpi-icon { background: #eff6ff; color: #2563eb; }

.kpi-card.loss::before { background: #dc2626; }
.kpi-card.loss .kpi-value { color: #dc2626; }
.kpi-card.loss .kpi-icon { background: #fef2f2; color: #dc2626; }

.kpi-card.margin::before { background: #7c3aed; }
.kpi-card.margin .kpi-value { color: #7c3aed; }
.kpi-card.margin .kpi-icon { background: #f5f3ff; color: #7c3aed; }

.kpi-card.receivable::before { background: #db2777; }
.kpi-card.receivable .kpi-value { color: #db2777; }
.kpi-card.receivable .kpi-icon { background: #fdf2f8; color: #db2777; }

.kpi-card.payable::before { background: #d97706; }
.kpi-card.payable .kpi-value { color: #d97706; }
.kpi-card.payable .kpi-icon { background: #fffbeb; color: #d97706; }

.kpi-card.cash::before { background: #0d9488; }
.kpi-card.cash .kpi-value { color: #0d9488; }
.kpi-card.cash .kpi-icon { background: #f0fdfa; color: #0d9488; }

.kpi-card.inventory::before { background: #475569; }
.kpi-card.inventory .kpi-value { color: #475569; }
.kpi-card.inventory .kpi-icon { background: #f8fafc; color: #475569; }

/* ─── Sections ─────────────────────────────────── */
.data-section,
.chart-section {
	background: #fff;
	border-radius: var(--fa-radius);
	border: 1px solid var(--fa-border);
	margin-bottom: 14px;
	overflow: hidden;
	width: 100%;
}

.section-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 12px 18px;
	border-bottom: 1px solid var(--fa-border);
	cursor: pointer;
	user-select: none;
}

.section-header:hover {
	background: #fafafa;
}

.section-header .section-icon {
	width: 28px; height: 28px;
	border-radius: 6px;
	display: inline-flex; align-items: center; justify-content: center;
	margin-left: 8px;
	font-size: 12px;
	flex-shrink: 0;
}

.section-title {
	font-size: 14px;
	font-weight: 700 !important;
	color: var(--fa-text);
	display: flex;
	align-items: center;
	gap: 6px;
}

.section-desc {
	font-size: 12px;
	color: var(--fa-text-sub);
	font-weight: 400 !important;
	padding: 0 18px 10px;
	border-bottom: 1px solid #f3f4f6;
}

.section-body {
	padding: 0;
	overflow-x: auto;
	overflow-y: auto;
	max-height: 500px;
}

.section-body::-webkit-scrollbar { width: 4px; height: 4px; }
.section-body::-webkit-scrollbar-track { background: transparent; }
.section-body::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 2px; }

.toggle-chevron {
	font-size: 10px;
	color: var(--fa-text-sub);
	transition: transform 0.2s ease;
	padding: 4px 6px;
}

.toggle-chevron.collapsed {
	transform: rotate(-90deg);
}

/* ─── Chart Containers ─────────────────────────── */
.chart-container {
	padding: 16px;
	min-height: 350px;
	direction: ltr;
}

/* ─── Tables — Aligned properly ────────────────── */
.audit-table {
	width: 100%;
	border-collapse: collapse;
}

.audit-table th,
.audit-table td {
	padding: 10px 14px;
	text-align: right;
	border-bottom: 1px solid #f3f4f6;
	font-size: 13px;
	font-weight: 500 !important;
	white-space: nowrap;
}

.audit-table th {
	font-weight: 700 !important;
	color: var(--fa-text-sub);
	font-size: 11px;
	text-transform: uppercase;
	letter-spacing: 0.02em;
	border-bottom: 2px solid var(--fa-border);
	position: sticky;
	top: 0;
	z-index: 2;
	background: #fff;
}

.audit-table tbody tr:hover {
	background: #f9fafb;
}

.audit-table .currency {
	font-variant-numeric: tabular-nums;
	font-weight: 600 !important;
}

.audit-table .positive { color: var(--fa-success); font-weight: 700 !important; }
.audit-table .negative { color: var(--fa-danger); font-weight: 700 !important; }

.audit-table a {
	color: var(--fa-primary);
	text-decoration: none;
	font-weight: 600 !important;
}

.audit-table a:hover {
	text-decoration: underline;
}

.audit-table td:first-child,
.audit-table th:first-child {
	text-align: center;
	width: 40px;
	color: var(--fa-text-sub);
}

/* ─── P&L ──────────────────────────────────────── */
.pnl-row.parent td {
	font-weight: 700 !important;
	background: #f9fafb;
	padding-top: 12px; padding-bottom: 12px;
}

.pnl-row.parent.income-header td { color: var(--fa-success); border-right: 3px solid var(--fa-success); }
.pnl-row.parent.expense-header td { color: var(--fa-danger); border-right: 3px solid var(--fa-danger); }
.pnl-row.child td:nth-child(2) { padding-right: 32px; }

.pnl-row.total td {
	font-weight: 700 !important;
	font-size: 14px;
	border-top: 2px solid var(--fa-text);
	background: #f3f4f6;
	padding-top: 12px; padding-bottom: 12px;
}

/* ─── Badges ───────────────────────────────────── */
.collection-bar { height: 6px; background: #e5e7eb; border-radius: 3px; overflow: hidden; margin-bottom: 2px; min-width: 50px; }
.collection-bar .fill { height: 100%; border-radius: 3px; }
.collection-bar .fill.good { background: var(--fa-success); }
.collection-bar .fill.medium { background: var(--fa-warning); }
.collection-bar .fill.poor { background: var(--fa-danger); }
.collection-rate-text { font-size: 10px; font-weight: 700 !important; color: var(--fa-text-sub); text-align: center; }

.aging-badge, .account-type-badge, .payment-type-badge {
	display: inline-flex; align-items: center; gap: 3px;
	padding: 2px 8px; border-radius: 12px;
	font-size: 11px; font-weight: 600 !important; white-space: nowrap;
}

.aging-badge.current { background: #ecfdf5; color: #065f46; }
.aging-badge.warning { background: #fffbeb; color: #92400e; }
.aging-badge.overdue { background: #fef2f2; color: #991b1b; }

.account-type-badge.bank-type { background: #eff6ff; color: #1e40af; }
.account-type-badge.cash-type { background: #ecfdf5; color: #065f46; }

.payment-type-badge.receive { background: #ecfdf5; color: #065f46; }
.payment-type-badge.pay { background: #fef2f2; color: #991b1b; }
.payment-type-badge.transfer { background: #eff6ff; color: #1e40af; }

.section-count {
	display: inline-flex; align-items: center; justify-content: center;
	background: var(--fa-primary); color: white;
	font-size: 10px; font-weight: 700 !important;
	padding: 1px 7px; border-radius: 8px; min-width: 20px;
}

.table-total-row td {
	font-weight: 700 !important;
	border-top: 2px solid var(--fa-text) !important;
	background: #f3f4f6 !important;
	padding-top: 10px !important; padding-bottom: 10px !important;
}

/* ─── Chart Stats ──────────────────────────────── */
.chart-stats {
	display: flex; justify-content: center; gap: 24px;
	padding: 12px 16px; border-top: 1px solid var(--fa-border);
}

.chart-stat-label { font-size: 10px; color: var(--fa-text-sub); font-weight: 600 !important; text-transform: uppercase; letter-spacing: 0.04em; margin-bottom: 2px; }
.chart-stat-value { font-size: 13px; font-weight: 700 !important; color: var(--fa-text); direction: ltr; }
.chart-stat-value.positive { color: var(--fa-success); }
.chart-stat-value.negative { color: var(--fa-danger); }

/* ─── AI Section ───────────────────────────────── */
.ai-analysis-section {
	background: #fff;
	border-radius: var(--fa-radius);
	border: 1px solid var(--fa-border);
	margin-bottom: 16px;
	overflow: hidden;
}

.ai-analysis-section .ai-header { border-bottom: 1px solid var(--fa-border); }
.ai-analysis-section .section-title { font-weight: 700 !important; font-size: 14px; }

.ai-analysis-section .close-ai-btn {
	color: var(--fa-text-sub); border: 1px solid var(--fa-border);
	background: #fff; border-radius: 4px; padding: 2px 10px; font-weight: 700 !important;
}

.ai-report {
	padding: 24px 28px; color: var(--fa-text);
	line-height: 1.9; font-size: 14px;
}

.ai-report-header {
	display: flex; align-items: center; gap: 8px;
	margin-bottom: 20px; padding-bottom: 12px; border-bottom: 2px solid var(--fa-border);
	font-size: 16px; font-weight: 700 !important; color: var(--fa-text);
}

.ai-report-header .ai-date { margin-right: auto; font-size: 12px; color: var(--fa-text-sub); font-weight: 400 !important; }
.ai-report h2, .ai-report h3, .ai-report h4 { color: var(--fa-text); font-weight: 700 !important; margin: 18px 0 8px; padding-bottom: 4px; border-bottom: 1px solid var(--fa-border); }
.ai-report h2 { font-size: 17px; } .ai-report h3 { font-size: 15px; } .ai-report h4 { font-size: 14px; }
.ai-report ul { padding-right: 20px; margin: 8px 0; }
.ai-report li { margin-bottom: 4px; font-weight: 500 !important; }
.ai-report strong { color: var(--fa-primary); font-weight: 700 !important; }
.ai-report p { margin-bottom: 8px; font-weight: 500 !important; }

.ai-summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px; }
.ai-summary-card { border: 1px solid var(--fa-border); border-radius: 8px; padding: 14px; text-align: center; }
.ai-summary-card .label { font-size: 10px; color: var(--fa-text-sub); margin-bottom: 4px; font-weight: 700 !important; text-transform: uppercase; letter-spacing: 0.04em; }
.ai-summary-card .value { font-size: 20px; font-weight: 700 !important; direction: ltr; }
.ai-summary-card .sub { font-size: 11px; font-weight: 600 !important; margin-top: 2px; }

.ai-data-table { width: 100%; border-collapse: collapse; font-size: 13px; margin-bottom: 16px; }
.ai-data-table th { padding: 6px 10px; text-align: right; color: var(--fa-text-sub); font-weight: 700 !important; font-size: 10px; text-transform: uppercase; border-bottom: 2px solid var(--fa-border); }
.ai-data-table td { padding: 6px 10px; border-bottom: 1px solid #f3f4f6; font-weight: 500 !important; }
.ai-data-table td.num { color: var(--fa-text-sub); font-weight: 700 !important; text-align: center; width: 28px; }
.ai-data-table td.currency-val { direction: ltr; text-align: left; font-weight: 700 !important; }

.ai-section-title { font-size: 14px; font-weight: 700 !important; color: var(--fa-text); margin: 0 0 10px; padding-bottom: 6px; border-bottom: 1px solid var(--fa-border); display: flex; align-items: center; gap: 6px; }
.ai-section-title i { color: var(--fa-primary); }

.ai-analysis-section .loading-state,
.ai-analysis-section .empty-state { color: var(--fa-text); }

/* ─── States ───────────────────────────────────── */
.empty-state { text-align: center; padding: 32px 20px; color: var(--fa-text-sub); }
.empty-state .empty-icon { width: 40px; height: 40px; border-radius: 10px; background: #f3f4f6; display: flex; align-items: center; justify-content: center; margin: 0 auto 8px; font-size: 16px; color: #d1d5db; }
.empty-state p { font-size: 13px; font-weight: 500 !important; }

.loading-state { text-align: center; padding: 32px; color: var(--fa-text-sub); font-size: 14px; font-weight: 500 !important; }
.loading-state i { margin-left: 6px; }

/* ─── Responsive ───────────────────────────────── */
@media (max-width: 1200px) {
	.kpi-cards { grid-template-columns: repeat(4, 1fr); }
	.ai-summary-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 768px) {
	.financial-audit-page { padding: 10px; }
	.kpi-cards { grid-template-columns: repeat(2, 1fr); gap: 8px; }
	.filters-row { flex-direction: column; }
	.filter-field { width: 100%; min-width: unset; }
	.chart-stats { flex-wrap: wrap; gap: 10px; }
	.section-header { padding: 10px 14px; }
	.ai-summary-grid { grid-template-columns: 1fr 1fr; }
}

@media (max-width: 480px) {
	.kpi-cards { grid-template-columns: 1fr 1fr; }
	.ai-report { padding: 14px; font-size: 13px; }
	.chart-container { padding: 10px; min-height: 260px; }
	.ai-summary-grid { grid-template-columns: 1fr; }
}

@media print {
	.financial-audit-page { background: white; padding: 0; }
	.filters-section, .toggle-chevron, .ai-analysis-section { display: none !important; }
	.data-section, .chart-section { box-shadow: none; border: 1px solid #ddd; break-inside: avoid; }
	.section-body { max-height: unset !important; overflow: visible !important; display: block !important; }
}
